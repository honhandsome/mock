<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>MOCK HTTP</title>
    <script type="text/javascript">
        var path = ""

        window.onload = function () {
            path = window.location.search.replace("?path=", "")
            getRequest()
            document.title = path
            document.getElementById("title-text").innerText = path
        }

        function getRequest() {
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    var httpEntity = JSON.parse(xmlhttp.responseText)
                    var general = "Request Url: " + httpEntity.requestUrl
                        + "\nRequest Method: " + httpEntity.requestMethod
                        + "\nStatus Code: " + httpEntity.statusCode
                    document.getElementById("general").innerText = general
                    document.getElementById("request-header").innerText = httpEntity.requestHeader
                    document.getElementById("query-parameter").innerText = httpEntity.queryParameter
                    document.getElementById("request-body").innerText = httpEntity.requestBody
                    document.getElementById("response-header").innerText = httpEntity.responseHeader
                    document.getElementById("response-body").value = httpEntity.responseBody
                }
            }
            xmlhttp.open("POST", "/getRequest", true);
            xmlhttp.setRequestHeader("Content-type", "application/json");
            var body = {};
            body.path = path;
            xmlhttp.send(JSON.stringify(body));
        }

        function mock() {
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function () {
                if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                    alert("MOCK SUCCESS");
                }
            }
            xmlhttp.open("POST", "/mock", true);
            xmlhttp.setRequestHeader("Content-type", "application/json");
            var body = {};
            body.path = path;
            body.responseBody = encodeURI(document.getElementById("response-body").value);
            xmlhttp.send(JSON.stringify(body));
        }
    </script>

    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
            border: 0;
            overflow-x: hidden;
        }

        #title-bar {
            width: 100%;
            height: 60px;
            background: #2196f3;
            padding-left: 32px;
            padding-right: 32px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            display: flex;
            flex-direction: row;
            align-items: center;
        }

        #title-text {
            color: white;
            font-size: 20px;
            font-weight: bold;
        }

        #content {
            width: 100%;
            flex-grow: 1;
            margin-top: 60px;
            margin-bottom: 20px;
            padding-left: 32px;
            padding-right: 32px;
            display: flex;
            flex-direction: column;
        }

        .text {
            color: #757575;
        }

        #mock-button {
            width: 100px;
            padding-top: 10px;
            padding-bottom: 10px;
            background: #2196f3;
            text-align: center;
            color: white;
        }

        #response-body {
            height: 700px;
            margin-top: 20px;
        }
    </style>
</head>

<body>
    <div id="title-bar">
        <div id="title-text"></div>
    </div>
    <div id="content">
        <h4>General</h4>
        <div id="general" class="text"></div>
        <h4>Request Header</h4>
        <div id="request-header" class="text"></div>
        <h4>Query Parameter</h4>
        <div id="query-parameter" class="text"></div>
        <h4>Request Body</h4>
        <div id="request-body" class="text"></div>
        <h4>Response Header</h4>
        <div id="response-header" class="text"></div>
        <h4>Response Body</h4>
        <div id="mock-button" onclick="mock()">MOCK</div>
        <textarea id="response-body"></textarea>
    </div>
    <a href="https://github.com/wangchenyan/mock-http" target="_blank" style="position:fixed;top:0px;right:0px;">
        <img width="149" height="149"
            src="https://github.blog/wp-content/uploads/2008/12/forkme_right_green_007200.png?resize=149%2C149"
            class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
</body>

</html>